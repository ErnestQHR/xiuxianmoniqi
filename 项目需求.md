# 1. 项目概述
修仙模拟器是一款基于控制台的文字角色扮演游戏（RPG），玩家通过修炼、突破境界、触发
随机事件等方式提升角色能力，最终达成修仙目标。游戏融合随机事件、策略选择和角色成长系

# 2.项目：修仙模拟器 详细需求文档
## 版本号：1.2
技术栈：Java 11 + ANSI控制台 + 二进制文件存储
统，支持存档与成就解锁，适合团队协作开发，重点训练面向对象设计、文件操作及算法逻辑。 功能需求
## 2.1 角色属性与成长系统
• 核心属性：
• 境界：凡人、练气、筑基、金丹、元婴、化神（共6层，每层分初期/中期/后期）。
• 修为值：通过修炼或丹药积累，满值可触发境界突破。
• 寿命：初始100年，每突破一境增加50年，耗尽则游戏结束。
• 灵石：货币，用于购买丹药或触发事件。
• 心法：影响修炼效率（如《基础吐纳术》《九转玄功》）。
• 成长机制：
• 修炼：每次修炼增加修为，耗时1年，效率受心法影响。
• 炼丹：消耗灵石炼制丹药（如聚气丹+50修为，渡劫丹提升突破概率）。
• 探索：随机触发事件（福缘/灾厄），可能获得灵石或损失寿命。
## 2.2 境界突破系统
• 突破条件：
• 修为值达到当前境界上限（例：筑基后期→金丹需修为≥500）。
• 概率成功（基础概率60%，受丹药/心法加成）。
• 突破结果：
• 成功：提升境界，重置修为值，增加寿命。
• 失败：修为值减半，寿命减少10年（可被渡劫丹抵消）。
• 突破动画：控制台输出动态进度条与结果提示。
> 尝试突破金丹境... [=====>] 75%
> 突破失败！修为损失50%，寿命-10年！

## 2.3 随机事件系统
• 事件库：从 events.txt 加载50+预设事件，分类为：
• 福缘：发现灵石矿（+200灵石）、顿悟（修为+100）。
• 灾厄：遭遇心魔（修为-30）、渡劫失败（寿命-20）。
• 奇遇：获得上古心法（《太虚剑典》修炼效率+30%）。
• 触发规则：
• 每次修炼/探索有20%概率触发随机事件。
• 事件结果实时影响角色状态。
## 2.4 存档与成就系统
• 存档管理：
• 自动保存至 savegame.dat （加密格式，防止直接修改）。
• 支持手动存档/读档，显示存档时间与角色境界。
• 成就系统：
• 隐藏成就：如“百年金丹”（100年内突破金丹）、“灵石大亨”（累计获得1万灵石）。
• 成就奖励：解锁特殊称号（显示在角色状态页）。

## 2.5 管理员模式
• 调试功能：
• 修改角色属性（仅供测试，正式版隐藏）。
• 强制触发指定事件（输入事件ID）。
• 数据监控：实时查看事件触发统计与平衡性数据。
# 3. 非功能需求
## 3.1 性能要求
• 境界突破计算响应时间≤0.3秒。
• 加载存档文件时间≤2秒（即使存档包含100+事件记录）。
## 3.2 可靠性要求
• 存档文件损坏时自动恢复至最近备份（ savegame_backup.dat ）。
• 事件库缺失时启用默认内置事件（防止游戏崩溃）。
## 3.3 安全性要求
• 存档文件使用简单加密（如字符ASCII码+5）。
• 用户输入过滤非法字符（如 | 、 $ ），防止注入攻击。
# 4. 系统设计
## 4.1 技术架构
• 数据层：
• SaveManager ：处理存档加密/解密，JSON格式序列化。
• EventLoader ：从文件加载事件库到 ArrayList<Event> 。
• 业务层：
• CultivationSystem ：管理修炼、突破、丹药使用逻辑。
• EventEngine ：随机事件触发与结果处理。
• 表示层：
• GameUI ：控制台菜单渲染与交互动画（如突破进度条）。
4.2 类图（UML）
+----------------+ +---------------------+
| SaveManager | | CultivationSystem |
|----------------| |---------------------|
| +encrypt() |<------| -currentStage: String|
| +decrypt() | | +breakthrough() |
+----------------+ +---------------------+
▲ ▲
| |
+----------------+ +---------------------+
| EventLoader | | GameUI |
|----------------| |---------------------|
| +loadEvents() | | +showStatus() |
| +getRandomEvent|<------| +handleInput() |
+----------------+ +---------------------+
4.3 文件格式示例
• 事件库（events.txt）：
EVENT001|福缘|发现灵石矿|灵石+200
EVENT002|灾厄|遭遇心魔|修为-30
EVENT003|奇遇|获得《太虚剑典》|心法效率+30%
• 存档文件（savegame.dat）：
{
"stage": "筑基中期",
"cultivation": 320,
"lifespan": 85,
"achievements": ["百年金丹"]
}
5. 用户界面流程
5.1 主菜单
=== 修仙模拟器 ===
1. 开始修炼
2. 炼制丹药
3. 探索秘境
4. 角色状态
5. 保存游戏
6. 退出游戏
请输入选项（1-6）：
5.2 角色状态页
=== 当前状态 ===
境界：筑基后期
修为：480/500
寿命：130年
灵石：1500
心法：《九转玄功》（效率+20%）
成就：暂无
6. 测试用例
场景 输入 预期输出
正常突破金丹境 修为500，使用渡劫丹 突破成功，境界更新为金丹初期
寿命耗尽 寿命降至0 显示“陨落”结局并返回主菜单
触发奇遇事件 探索秘境 随机获得心法或灵石
存档损坏恢复 删除savegame.dat 自动加载备份存档并提示
成就解锁 百年内突破金丹 显示成就“百年金丹”
7. 验收标准
1. 实现核心玩法循环（修炼→突破→事件→成长）。
2. 数据持久化：存档跨会话有效，事件库可扩展。
3. 异常处理：覆
盖 InvalidStageException 、 SaveCorruptedException 、 EventLoadException 。
4. 提供完整文档：UML类图、事件设计表、测试报告。
5. 控制台动态效果：进度条、彩色文字（ANSI转义码）。
8. 附录
• 开发周期：6天（3天核心逻辑，2天事件系统，1天测试优化）。
• 团队分工建议：
• 成员A：角色系统与突破算法
• 成员B：事件管理与存档处理
• 成员C：用户界面与输入验证
• 成员D（可选）：成就系统与平衡性调整